# 餐車排班後台管理系統使用說明

## 📋 系統概述

後台管理系統提供完整的預約管理功能，可以查看、編輯、刪除所有預約記錄，並提供強大的篩選和搜尋功能。

## 🚀 快速開始

### 1. 更新 Google Apps Script

首先，需要將更新後的 `google_apps_script.js` 上傳到 Google Apps Script：

1. 打開 [Google Apps Script](https://script.google.com/)
2. 找到您的專案
3. 將 `google_apps_script.js` 中的新代碼（`updateBooking` 函數）添加到您的專案中
4. 保存並重新部署為 Web App

### 2. 設定管理密碼

打開 `admin.js` 文件，找到以下行：

```javascript
const ADMIN_PASSWORD = 'admin123'; // ⚠️ 請修改此密碼！
```

將 `'admin123'` 修改為您想要的管理密碼。

### 3. 確認 API URL

確認 `admin.js` 中的 `API_URL` 與您的 Google Apps Script Web App URL 一致：

```javascript
const API_URL = 'https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec';
```

### 4. 開啟後台頁面

在瀏覽器中打開 `admin.html` 即可使用後台管理系統。

## 🔐 登入系統

1. 打開 `admin.html`
2. 輸入管理密碼（預設為 `admin123`，請記得修改）
3. 點擊「登入」按鈕

**安全提示：**
- 登入狀態會保存在 `sessionStorage` 中，關閉瀏覽器後需要重新登入
- 建議使用強密碼，並定期更換

## 📊 功能說明

### 1. 統計資訊

頂部顯示四個統計卡片：
- **總預約數**：所有預約的總數
- **已付款**：付款狀態為「己繳款」的預約數
- **未付款**：付款狀態為「未繳款」的預約數
- **逾期可排**：付款狀態為「逾繳可排」的預約數

### 2. 篩選功能

提供多種篩選方式：

- **搜尋**：可搜尋餐車名稱、場地、日期、餐車類型
- **場地篩選**：選擇特定場地
- **日期範圍**：選擇開始和結束日期
- **付款狀態**：篩選已付款、未付款或逾期可排

### 3. 預約列表

顯示所有預約的詳細資訊：
- 時間戳記
- 餐車名稱
- 餐車類型
- 場地
- 日期
- 狀態
- 場地費
- 付款狀態
- 備註
- 操作按鈕

### 4. 編輯預約

點擊「編輯」按鈕可以修改預約資訊：

- **餐車名稱**（必填）
- **餐車類型**
- **場地**（必填）
- **日期**（必填）
- **狀態**：己排、未排、取消
- **場地費**
- **付款狀態**：未繳款、己繳款、逾繳可排
- **備註**

修改後點擊「儲存」即可更新到 Google Sheets。

### 5. 刪除預約

點擊「刪除」按鈕會顯示確認對話框，確認後會刪除該預約記錄。

**注意：** 刪除操作無法復原，請謹慎操作。

### 6. 重新載入

點擊頂部導航欄的「重新載入」按鈕可以重新從 Google Sheets 載入最新數據。

## 🎨 介面特色

- **現代化設計**：使用漸層色和卡片式設計
- **響應式布局**：支援桌面和行動裝置
- **即時反饋**：操作後立即顯示 Toast 通知
- **載入指示器**：處理數據時顯示載入動畫

## 🔧 技術細節

### 數據結構

每個預約記錄包含以下欄位：

```javascript
{
  timestamp: "2025-10-14T10:30:00Z",  // 時間戳記
  vendor: "向陽坡刈包",                // 餐車名稱
  foodType: "主食類",                  // 餐車類型
  location: "四維路59號",             // 場地
  date: "10月13日(星期一)",           // 日期
  status: "己排",                      // 狀態
  bookedStatus: "己排",               // 預約狀態
  fee: "600元/天",                    // 場地費
  payment: "己繳款",                  // 付款狀態
  note: "備註資訊",                   // 備註
  rowNumber: 10                       // Google Sheets 行號
}
```

### API 端點

後台系統使用以下 API：

1. **獲取所有預約**：`GET ?action=getBookings`
2. **更新預約**：`POST { action: 'updateBooking', ... }`
3. **刪除預約**：`POST { action: 'delete', ... }`

## ⚠️ 注意事項

1. **密碼安全**：請務必修改預設密碼
2. **數據備份**：建議定期備份 Google Sheets 數據
3. **權限控制**：後台系統沒有額外的權限驗證，請妥善保管密碼
4. **網路連線**：需要穩定的網路連線才能正常運作
5. **瀏覽器相容性**：建議使用 Chrome、Firefox、Edge 等現代瀏覽器

## 🐛 常見問題

### Q: 無法登入？
A: 請確認：
- 密碼是否正確（檢查 `admin.js` 中的 `ADMIN_PASSWORD`）
- 瀏覽器是否支援 `sessionStorage`

### Q: 無法載入預約數據？
A: 請檢查：
- API URL 是否正確
- Google Apps Script 是否已正確部署
- 網路連線是否正常
- 瀏覽器控制台是否有錯誤訊息

### Q: 編輯後無法儲存？
A: 請確認：
- Google Apps Script 中是否已添加 `updateBooking` 函數
- 是否已重新部署 Web App
- 表單是否填寫完整（必填欄位）

### Q: 刪除後數據還在？
A: 請確認：
- Google Apps Script 中是否已添加 `deleteBooking` 函數
- 是否已重新部署 Web App
- 點擊「重新載入」按鈕刷新數據

## 📝 更新日誌

### v1.0.0 (2025-10-14)
- ✅ 初始版本發布
- ✅ 基本 CRUD 功能
- ✅ 篩選和搜尋功能
- ✅ 統計資訊顯示
- ✅ 響應式設計

## 📞 技術支援

如有問題或建議，請聯繫開發團隊。

---

**開發者提示：** 如需自訂功能，請修改 `admin.js` 和 `admin.css` 文件。
