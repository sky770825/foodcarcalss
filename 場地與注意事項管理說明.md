# 場地管理與注意事項管理功能說明

## 📋 功能概述

後台管理系統現在支援兩個新功能：

1. **場地管理**：管理前端場地配置、開放日期和注意事項
2. **注意事項管理**：管理前端顯示的重要注意事項

## 🗄️ 資料庫設定

在使用這些功能之前，請確保 Supabase 中已經創建了必要的資料表。

### 執行 SQL 腳本

1. 登入 Supabase Dashboard：https://supabase.com/dashboard/project/sqgrnowrcvspxhuudrqc
2. 進入 **SQL Editor**
3. 執行 `supabase_settings_setup.sql` 文件中的 SQL 腳本

這個腳本會創建：
- `location_settings` 表：儲存場地配置
- `frontend_notices` 表：儲存前端注意事項

### 手動執行 SQL

如果無法執行完整腳本，可以手動執行以下 SQL：

```sql
-- 創建場地配置表
CREATE TABLE IF NOT EXISTS location_settings (
  id BIGSERIAL PRIMARY KEY,
  location_key TEXT NOT NULL UNIQUE,
  location_name TEXT NOT NULL,
  address TEXT NOT NULL,
  location_type TEXT DEFAULT '戶外場地',
  enabled BOOLEAN DEFAULT true,
  available_days INTEGER[] DEFAULT ARRAY[0,1,2,3,4,5,6],
  time_slots TEXT[] DEFAULT ARRAY['14:00-20:00'],
  price_per_slot JSONB DEFAULT '{"14:00-20:00": "600元"}'::jsonb,
  info JSONB DEFAULT '{}'::jsonb,
  notices TEXT[] DEFAULT ARRAY[]::TEXT[],
  closed_dates DATE[] DEFAULT ARRAY[]::DATE[],
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- 創建前端注意事項表
CREATE TABLE IF NOT EXISTS frontend_notices (
  id BIGSERIAL PRIMARY KEY,
  notice_key TEXT NOT NULL UNIQUE,
  title TEXT NOT NULL,
  content TEXT NOT NULL,
  display_order INTEGER DEFAULT 0,
  enabled BOOLEAN DEFAULT true,
  notice_type TEXT DEFAULT 'general',
  target_location TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- 啟用 RLS 並設定政策（允許公開讀寫）
ALTER TABLE location_settings ENABLE ROW LEVEL SECURITY;
ALTER TABLE frontend_notices ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Allow public read access" ON location_settings FOR SELECT USING (true);
CREATE POLICY "Allow public insert" ON location_settings FOR INSERT WITH CHECK (true);
CREATE POLICY "Allow public update" ON location_settings FOR UPDATE USING (true);
CREATE POLICY "Allow public delete" ON location_settings FOR DELETE USING (true);

CREATE POLICY "Allow public read access" ON frontend_notices FOR SELECT USING (true);
CREATE POLICY "Allow public insert" ON frontend_notices FOR INSERT WITH CHECK (true);
CREATE POLICY "Allow public update" ON frontend_notices FOR UPDATE USING (true);
CREATE POLICY "Allow public delete" ON frontend_notices FOR DELETE USING (true);
```

## 🎯 使用方式

### 場地管理

1. 點擊後台頂部的「場地管理」標籤
2. 點擊「新增場地」按鈕
3. 填寫場地資訊：
   - **場地識別碼**：唯一識別碼（例如：四維路59號）
   - **顯示名稱**：前端顯示的名稱
   - **完整地址**：場地的完整地址
   - **場地類型**：戶外場地、店面場地等
   - **可預約星期**：選擇哪些星期可以預約
   - **可用時段**：例如「14:00-20:00」
   - **場地費用**：例如「600元/天」
   - **場地限制**：例如「僅限1車」
   - **禁止事項**：例如「飲料車、素食」
   - **特殊說明**：特殊規則
   - **注意事項**：每行一條
4. 點擊「儲存」

### 注意事項管理

1. 點擊後台頂部的「注意事項管理」標籤
2. 點擊「新增注意事項」按鈕
3. 填寫注意事項資訊：
   - **識別碼**：唯一識別碼（只能包含小寫字母、數字和連字號）
   - **標題**：注意事項標題
   - **內容**：注意事項詳細內容
   - **類型**：一般、警告、資訊、成功
   - **針對場地**：選擇特定場地或留空（通用）
   - **顯示順序**：數字越小越靠前
4. 點擊「儲存」

## 🔧 功能說明

### 場地管理功能

- ✅ **新增場地**：添加新的場地配置
- ✅ **編輯場地**：修改現有場地資訊
- ✅ **啟用/停用**：控制場地是否在前端顯示
- ✅ **刪除場地**：永久刪除場地配置
- ✅ **查看詳情**：查看場地的完整配置資訊

### 注意事項管理功能

- ✅ **新增注意事項**：添加新的注意事項
- ✅ **編輯注意事項**：修改現有注意事項
- ✅ **啟用/停用**：控制注意事項是否在前端顯示
- ✅ **刪除注意事項**：永久刪除注意事項
- ✅ **分類管理**：支援不同類型的注意事項（一般、警告、資訊、成功）

## 📝 注意事項

1. **場地識別碼**必須唯一，不能重複
2. **注意事項識別碼**必須唯一，且只能包含小寫字母、數字和連字號
3. 停用的場地不會在前端顯示
4. 停用的注意事項不會在前端顯示
5. 刪除操作無法復原，請謹慎操作

## 🚀 下一步

完成資料庫設定後，這些功能就可以正常使用了。前端代碼需要更新以從 Supabase 讀取場地配置和注意事項，而不是使用硬編碼的配置。
