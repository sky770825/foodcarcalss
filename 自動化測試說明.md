# 標籤頁切換功能自動化測試

## 功能說明

這個自動化測試腳本會自動：
1. 啟動瀏覽器並訪問後台管理頁面
2. 自動登入系統
3. 測試標籤頁切換功能
4. 驗證每個標籤頁是否正確顯示/隱藏
5. 生成測試截圖和報告

## 安裝依賴

```bash
npm install
```

## 運行測試

### 前置條件

1. 確保本地服務器正在運行：
```bash
npm run serve
# 或
npm run dev
```

2. 確保服務器運行在 `http://localhost:5000`（或修改測試腳本中的 URL）

### 執行測試

#### 方式一：自動模式（推薦）
自動啟動服務器、運行測試、清理：
```bash
# 使用 npm 腳本
npm run test:tabs:auto

# 或直接執行 shell 腳本
./run_tab_test.sh
```

#### 方式二：手動模式
需要先啟動服務器：
```bash
# 1. 啟動服務器（在另一個終端）
npm run serve

# 2. 運行測試
npm run test:tabs
```

#### 運行所有測試
```bash
npm run test:all
```

## 測試內容

測試腳本會驗證以下功能：

1. **初始狀態檢查**
   - 預約管理標籤頁應該可見
   - 場地管理和注意事項管理標籤頁應該隱藏

2. **場地管理標籤頁切換**
   - 點擊場地管理按鈕
   - 驗證場地管理標籤頁顯示
   - 驗證其他標籤頁隱藏
   - 驗證場地列表容器存在

3. **注意事項管理標籤頁切換**
   - 點擊注意事項管理按鈕
   - 驗證注意事項管理標籤頁顯示
   - 驗證其他標籤頁隱藏
   - 驗證注意事項列表容器存在

4. **預約管理標籤頁切換**
   - 切換回預約管理標籤頁
   - 驗證預約管理標籤頁顯示
   - 驗證其他標籤頁隱藏
   - 驗證預約列表容器存在

## 測試結果

測試完成後會：
- 在控制台顯示詳細的測試結果
- 生成測試截圖保存在 `test_screenshots/` 目錄
- 返回退出碼：0（成功）或 1（失敗）

## 測試截圖

測試過程中會自動生成以下截圖：
- `01_login.png` - 登入畫面
- `02_main_content.png` - 主內容載入
- `03_locations_tab.png` - 場地管理標籤頁
- `04_notices_tab.png` - 注意事項管理標籤頁
- `05_bookings_tab_after_switch.png` - 切換回預約管理標籤頁
- `error.png` - 如果發生錯誤

## 配置選項

可以在 `test_tab_switching.js` 中修改以下配置：

```javascript
const TEST_CONFIG = {
  adminUrl: 'http://localhost:5000/admin.html',  // 後台管理頁面 URL
  adminPassword: 'admin123',                     // 管理密碼
  timeout: 30000,                               // 超時時間（毫秒）
  headless: true,                               // 是否無頭模式（false 可以看到瀏覽器）
  screenshotPath: './test_screenshots'          // 截圖保存路徑
};
```

## 故障排除

如果測試失敗：

1. **檢查服務器是否運行**
   ```bash
   npm run serve
   ```

2. **檢查 URL 是否正確**
   - 確認 `adminUrl` 配置正確
   - 確認端口號是否匹配

3. **檢查管理密碼**
   - 確認 `adminPassword` 與實際密碼一致

4. **查看截圖**
   - 檢查 `test_screenshots/` 目錄中的截圖
   - 查看錯誤截圖 `error.png`

5. **查看控制台輸出**
   - 測試腳本會輸出詳細的日誌信息
   - 檢查是否有錯誤訊息

## 持續集成

可以將此測試腳本整合到 CI/CD 流程中：

```yaml
# GitHub Actions 示例
- name: Run Tab Switching Tests
  run: |
    npm install
    npm run serve &
    sleep 5
    npm run test:tabs
```
