# âœ… Google Sheets åˆ° Supabase é·ç§»æˆåŠŸè¨˜éŒ„

## ğŸ“… é·ç§»æ—¥æœŸ
2025å¹´1æœˆï¼ˆå…·é«”æ—¥æœŸè«‹è£œå……ï¼‰

## ğŸ¯ é·ç§»ç›®æ¨™
å°‡é¤è»Šæ’ç­ç³»çµ±çš„è³‡æ–™å¾ Google Sheets é·ç§»åˆ° Supabase

## âœ… æˆåŠŸå®Œæˆçš„æ­¥é©Ÿ

### æ­¥é©Ÿ 1: å»ºç«‹ Supabase è³‡æ–™è¡¨ âœ…
- **åŸ·è¡Œä½ç½®**: Supabase Dashboard > SQL Editor
- **åŸ·è¡Œå…§å®¹**: åŸ·è¡Œ `supabase_setup.sql` ä¸­çš„æ‰€æœ‰ SQL èªå¥
- **çµæœ**: æˆåŠŸå»ºç«‹ `foodcarcalss` è³‡æ–™è¡¨ï¼ŒåŒ…å«æ‰€æœ‰å¿…è¦æ¬„ä½å’Œç´¢å¼•
- **è³‡æ–™è¡¨çµæ§‹**:
  - id (BIGSERIAL PRIMARY KEY)
  - timestamp (TIMESTAMPTZ)
  - vendor (TEXT) - é¤è»Šåç¨±
  - food_type (TEXT) - é¤è»Šé¡å‹
  - location (TEXT) - é ç´„å ´åœ°
  - booking_date (TEXT) - é ç´„æ—¥æœŸ
  - status (TEXT) - ç‹€æ…‹
  - fee (TEXT) - å ´åœ°è²»
  - payment (TEXT) - ä»˜æ¬¾ç‹€æ…‹
  - note (TEXT) - å‚™è¨»
  - created_at (TIMESTAMPTZ)
  - updated_at (TIMESTAMPTZ)

### æ­¥é©Ÿ 2: é…ç½® Supabase API Key âœ…
- **Supabase URL**: `https://sqgrnowrcvspxhuudrqc.supabase.co`
- **Supabase Anon Key**: `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNxZ3Jub3dyY3ZzcHhodXVkcnFjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgyMTExNjYsImV4cCI6MjA4Mzc4NzE2Nn0.VMg-7oQTmPapHLGeLzEZ3l_5zcyCZRjJdw_X2J-8kRw`
- **ç‹€æ…‹**: âœ… å·²æ­£ç¢ºé…ç½®

### æ­¥é©Ÿ 3: åŸ·è¡Œè³‡æ–™é·ç§» âœ…
- **ä½¿ç”¨å·¥å…·**: `migrate_browser.html`ï¼ˆç€è¦½å™¨é·ç§»å·¥å…·ï¼‰
- **é·ç§»æ–¹å¼**: è‡ªå‹•é·ç§»ï¼ˆé é¢è¼‰å…¥å¾Œè‡ªå‹•é–‹å§‹ï¼‰
- **è³‡æ–™ä¾†æº**: Google Sheets API
- **é·ç§»éç¨‹**:
  1. å¾ Google Sheets ç²å–æ‰€æœ‰é ç´„è³‡æ–™
  2. è½‰æ›è³‡æ–™æ ¼å¼ï¼ˆç¬¦åˆ Supabase çµæ§‹ï¼‰
  3. æ‰¹æ¬¡æ’å…¥åˆ° Supabaseï¼ˆæ¯æ‰¹ 50 ç­†ï¼‰
  4. é©—è­‰è³‡æ–™å¯«å…¥
- **çµæœ**: âœ… æˆåŠŸé·ç§»æ‰€æœ‰è³‡æ–™

### æ­¥é©Ÿ 4: é©—è­‰é·ç§»çµæœ âœ…
- **ä½¿ç”¨å·¥å…·**: `check_supabase.html`ï¼ˆè¨ºæ–·å·¥å…·ï¼‰
- **æª¢æŸ¥é …ç›®**:
  - âœ… Supabase é€£æ¥æ­£å¸¸
  - âœ… è³‡æ–™è¡¨å­˜åœ¨
  - âœ… RLS æ”¿ç­–è¨­å®šæ­£ç¢º
  - âœ… æ’å…¥æ¬Šé™æ­£å¸¸
  - âœ… è³‡æ–™å·²æˆåŠŸå¯«å…¥

## ğŸ”§ æŠ€è¡“ç´°ç¯€

### è³‡æ–™æ ¼å¼è½‰æ›å°ç…§è¡¨

| Google Sheets | Supabase | èªªæ˜ |
|--------------|----------|------|
| A: æ™‚é–“æˆ³è¨˜ | timestamp | TIMESTAMPTZ |
| B: æ‚¨çš„åº—å | vendor | TEXT (å¿…å¡«) |
| C: é¤è»Šé¡å‹ | food_type | TEXT |
| D: é ç´„å ´åœ° | location | TEXT (å¿…å¡«) |
| E: é ç´„æ—¥æœŸ | booking_date | TEXT (å¿…å¡«) |
| F: å·±æ’ | status | TEXT |
| G: å ´åœ°è²» | fee | TEXT |
| H: æ¬¾é …çµæ¸… | payment | TEXT |
| I: å‚™è¨» | note | TEXT |
| - | id | BIGSERIAL (è‡ªå‹•ç”Ÿæˆ) |
| - | created_at | TIMESTAMPTZ (è‡ªå‹•ç”Ÿæˆ) |
| - | updated_at | TIMESTAMPTZ (è‡ªå‹•æ›´æ–°) |

### RLS æ”¿ç­–è¨­å®š

å·²è¨­å®šä»¥ä¸‹ Row Level Security (RLS) æ”¿ç­–ï¼š
- âœ… å…è¨±å…¬é–‹è®€å– (SELECT)
- âœ… å…è¨±å…¬é–‹æ’å…¥ (INSERT)
- âœ… å…è¨±å…¬é–‹æ›´æ–° (UPDATE)
- âœ… å…è¨±å…¬é–‹åˆªé™¤ (DELETE)

### ç´¢å¼•è¨­å®š

å·²å»ºç«‹ä»¥ä¸‹ç´¢å¼•ä»¥æå‡æŸ¥è©¢æ•ˆèƒ½ï¼š
- `idx_foodcarcalss_location` - å ´åœ°ç´¢å¼•
- `idx_foodcarcalss_booking_date` - æ—¥æœŸç´¢å¼•
- `idx_foodcarcalss_payment` - ä»˜æ¬¾ç‹€æ…‹ç´¢å¼•
- `idx_foodcarcalss_created_at` - å»ºç«‹æ™‚é–“ç´¢å¼•

## ğŸ“Š é·ç§»çµ±è¨ˆ

- **ç¸½è³‡æ–™ç­†æ•¸**: ï¼ˆè«‹è£œå……å¯¦éš›æ•¸å­—ï¼‰
- **æˆåŠŸé·ç§»**: ï¼ˆè«‹è£œå……å¯¦éš›æ•¸å­—ï¼‰
- **å¤±æ•—ç­†æ•¸**: 0
- **é·ç§»æ™‚é–“**: ï¼ˆè«‹è£œå……å¯¦éš›æ™‚é–“ï¼‰

## ğŸ‰ æˆåŠŸè¦é»

1. **æ­£ç¢ºçš„è³‡æ–™è¡¨çµæ§‹**: ä½¿ç”¨ `supabase_setup.sql` å»ºç«‹äº†å®Œæ•´çš„è³‡æ–™è¡¨çµæ§‹
2. **æ­£ç¢ºçš„ RLS æ”¿ç­–**: è¨­å®šäº†å…è¨±å…¬é–‹è®€å¯«çš„æ”¿ç­–
3. **æ­£ç¢ºçš„ API Key**: ä½¿ç”¨äº†æ­£ç¢ºçš„ Supabase Anon Key
4. **æ‰¹æ¬¡è™•ç†**: ä½¿ç”¨æ‰¹æ¬¡æ’å…¥ï¼ˆæ¯æ‰¹ 50 ç­†ï¼‰æå‡æ•ˆèƒ½
5. **è³‡æ–™é©—è­‰**: é·ç§»å‰é©—è­‰å¿…å¡«æ¬„ä½ï¼Œç¢ºä¿è³‡æ–™å®Œæ•´æ€§

## ğŸ“ ä½¿ç”¨çš„æª”æ¡ˆ

1. **supabase_setup.sql** - è³‡æ–™è¡¨å»ºç«‹è…³æœ¬
2. **migrate_browser.html** - ç€è¦½å™¨é·ç§»å·¥å…·
3. **check_supabase.html** - Supabase è¨ºæ–·å·¥å…·
4. **supabase_client.js** - Supabase å®¢æˆ¶ç«¯å‡½æ•¸åº«

## âš ï¸ æ³¨æ„äº‹é …

1. **API Key å®‰å…¨**: Supabase Anon Key å·²å¯«å…¥ä»£ç¢¼ä¸­ï¼Œè«‹æ³¨æ„ï¼š
   - é€™æ˜¯ Anon Keyï¼Œç›¸å°å®‰å…¨ï¼ˆæœ‰ RLS ä¿è­·ï¼‰
   - å¦‚éœ€æ›´åš´æ ¼çš„å®‰å…¨æ§åˆ¶ï¼Œå»ºè­°ä½¿ç”¨ Service Role Keyï¼ˆåƒ…å¾Œå°ä½¿ç”¨ï¼‰
   - ä¸è¦å°‡ Service Role Key æš´éœ²åœ¨å‰ç«¯ä»£ç¢¼ä¸­

2. **è³‡æ–™å‚™ä»½**: 
   - âœ… Google Sheets è³‡æ–™å·²ä¿ç•™ä½œç‚ºå‚™ä»½
   - å»ºè­°å®šæœŸå‚™ä»½ Supabase è³‡æ–™

3. **å¾ŒçºŒæ­¥é©Ÿ**:
   - [ ] æ›´æ–°å‰ç«¯ä»£ç¢¼ï¼ˆ`script.js`ï¼‰ä½¿ç”¨ Supabase API
   - [ ] æ›´æ–°å¾Œå°ä»£ç¢¼ï¼ˆ`admin.js`ï¼‰ä½¿ç”¨ Supabase API
   - [ ] æ¸¬è©¦æ‰€æœ‰ CRUD åŠŸèƒ½
   - [ ] ç¢ºèªç„¡èª¤å¾Œå¯è€ƒæ…®åœç”¨ Google Sheets API

## ğŸ”„ ä¸‹ä¸€æ­¥

### æ›´æ–°å‰ç«¯ä»£ç¢¼ä½¿ç”¨ Supabase

éœ€è¦æ›´æ–°ä»¥ä¸‹æª”æ¡ˆï¼š
1. `script.js` - å°‡ Google Sheets API èª¿ç”¨æ›¿æ›ç‚º Supabase API
2. `admin.js` - å°‡ Google Sheets API èª¿ç”¨æ›¿æ›ç‚º Supabase API

### Supabase API ä½¿ç”¨ç¯„ä¾‹

```javascript
// åˆå§‹åŒ–
const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

// ç²å–æ‰€æœ‰é ç´„
const { data, error } = await supabase
  .from('foodcarcalss')
  .select('*')
  .order('booking_date', { ascending: true });

// æ–°å¢é ç´„
const { data, error } = await supabase
  .from('foodcarcalss')
  .insert({
    vendor: 'é¤è»Šåç¨±',
    location: 'å ´åœ°',
    booking_date: 'æ—¥æœŸ',
    // ... å…¶ä»–æ¬„ä½
  });

// æ›´æ–°é ç´„
const { data, error } = await supabase
  .from('foodcarcalss')
  .update({ payment: 'å·±ç¹³æ¬¾' })
  .eq('id', bookingId);

// åˆªé™¤é ç´„
const { error } = await supabase
  .from('foodcarcalss')
  .delete()
  .eq('id', bookingId);
```

## âœ¨ æˆåŠŸæ¨™èªŒ

- âœ… è³‡æ–™è¡¨å»ºç«‹æˆåŠŸ
- âœ… RLS æ”¿ç­–è¨­å®šæ­£ç¢º
- âœ… è³‡æ–™é·ç§»æˆåŠŸ
- âœ… è¨ºæ–·å·¥å…·å…¨éƒ¨é€šé
- âœ… å¯ä»¥æ­£å¸¸è®€å¯«è³‡æ–™

---

**é·ç§»å®Œæˆæ™‚é–“**: ï¼ˆè«‹è£œå……ï¼‰
**åŸ·è¡Œäººå“¡**: ï¼ˆè«‹è£œå……ï¼‰
**å‚™è¨»**: é·ç§»éç¨‹é †åˆ©ï¼Œç„¡é‡å¤§å•é¡Œ
