<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">
<title>楊梅餐車排班報名系統 v3.2</title>


<!-- Font Awesome -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

<!-- 外部樣式表 -->
<link rel="stylesheet" href="styles.css">

</head>
<body>

<!-- Hero Banner -->
<section class="hero">
  <div class="hero-content">
    <h1>🚚 楊梅餐車排班報名</h1>
    <p>立即預約您的餐車出攤檔期，隨時查看最新排班日曆</p>
    
    <!-- 快速功能連結 -->
    <div class="quick-links-grid">
      <a href="https://siwei.pages.dev/" target="_blank" class="quick-link-btn">
        <i class="fas fa-route"></i>
        <span>每日行程總覽</span>
      </a>
      
      <button onclick="showRulesModal()" class="quick-link-btn">
        <i class="fas fa-book"></i>
        <span>群組版規</span>
      </button>
      
      <button onclick="showDownloadModal()" class="quick-link-btn">
        <i class="fas fa-download"></i>
        <span>下載素材</span>
      </button>
      
      <a href="https://reurl.cc/G4KbgD" target="_blank" class="quick-link-btn">
        <i class="fas fa-users"></i>
        <span>加入預訂社群</span>
      </a>
      
      <a href="https://line.me/ti/g2/2-7-YZOXN4PysTdBsO7Kr4_q4UMlNxAGviawjg?utm_source=invitation&utm_medium=link_copy&utm_campaign=default" target="_blank" class="quick-link-btn">
        <i class="fas fa-store"></i>
        <span>餐車闆闆社群</span>
      </a>
    </div>
  </div>
</section>

<div class="container" id="mainContent" style="opacity: 0; transition: opacity 0.5s ease;">

  <!-- 排班行事曆 -->
  <div class="card">
    <div style="display: flex; justify-content: center; align-items: center; position: relative;">
      <h2 class="section-title">📅 排班行事曆</h2>
      <button onclick="showHelpModal()" class="help-btn" title="使用說明">
        <i class="fas fa-question"></i>
      </button>
    </div>
    
    <!-- 新的行事曆容器 -->
    <div class="calendar-container">
      <div class="calendar-header">
        <div class="calendar-nav">
          <button id="prevMonth" class="nav-btn"><i class="fas fa-chevron-left"></i></button>
          <span id="currentMonth" class="month-display">2025年10月</span>
          <button id="nextMonth" class="nav-btn"><i class="fas fa-chevron-right"></i></button>
          <button id="todayBtn" class="today-btn">今天</button>
        </div>
        <div class="location-filter">
          <label><i class="fas fa-filter"></i> 篩選場地：</label>
          <div class="location-filter-buttons">
            <button class="filter-btn active" data-location="四維路59號">
              <i class="fas fa-map-marker-alt"></i> 四維路59號
            </button>
            <button class="filter-btn" data-location="四維路60號">
              <i class="fas fa-map-marker-alt"></i> 四維路60號
            </button>
            <button class="filter-btn" data-location="漢堡大亨">
              <i class="fas fa-map-marker-alt"></i> 四維路70號
            </button>
            <button class="filter-btn" data-location="自由風">
              <i class="fas fa-map-marker-alt"></i> 四維路190號
            </button>
            <button class="filter-btn" data-location="蔬蒔">
              <i class="fas fa-map-marker-alt"></i> 四維路216號
            </button>
            <button class="filter-btn" data-location="金正好吃">
              <i class="fas fa-map-marker-alt"></i> 四維路218號
            </button>
          </div>
        </div>
      </div>
      
      <div class="calendar-grid" id="calendarGrid">
        <!-- 行事曆內容將由JavaScript生成 -->
      </div>
    </div>
  </div>

  <!-- 場地選擇 -->
  <div class="card">
    <h2 class="section-title">📍 選擇場地</h2>
    <div style="background: #e3f2fd; border-left: 4px solid #2196f3; padding: 12px 15px; margin-bottom: 15px; border-radius: 6px;">
      <p style="margin: 0; color: #1976d2; font-size: 0.9rem;">
        <i class="fas fa-lightbulb"></i> 💡 <strong>小提示：</strong>您可以直接點擊上方日曆的空白日期快速預約，或在此選擇場地查看詳細資訊
      </p>
    </div>
    <div class="location-tabs">
      <button class="location-tab active" data-location="四維路59號">
        <i class="fas fa-map-marker-alt"></i>
        <span>四維路59號</span>
        <small>楊梅區四維路59號</small>
        <img src="https://i.postimg.cc/wTB3mKM7/59.jpg" alt="四維路59號" class="location-thumbnail" data-full-image="https://i.postimg.cc/wTB3mKM7/59.jpg">
      </button>
      <button class="location-tab" data-location="四維路60號">
        <i class="fas fa-map-marker-alt"></i>
        <span>四維路60號</span>
        <small>楊梅區四維路60號</small>
        <img src="https://i.postimg.cc/Vsgdvsfr/60.jpg" alt="四維路60號" class="location-thumbnail" data-full-image="https://i.postimg.cc/Vsgdvsfr/60.jpg">
      </button>
      <button class="location-tab" data-location="漢堡大亨">
        <i class="fas fa-store"></i>
        <span>漢堡大亨</span>
        <small>楊梅區四維路70號</small>
        <img src="https://i.postimg.cc/zD7VvDzH/70.jpg" alt="漢堡大亨" class="location-thumbnail" data-full-image="https://i.postimg.cc/zD7VvDzH/70.jpg">
      </button>
      <button class="location-tab" data-location="自由風">
        <i class="fas fa-store"></i>
        <span>自由風</span>
        <small>楊梅區四維路190號</small>
        <img src="https://i.postimg.cc/nV2CrVFX/190.jpg" alt="自由風" class="location-thumbnail" data-full-image="https://i.postimg.cc/nV2CrVFX/190.jpg">
      </button>
      <button class="location-tab" data-location="蔬蒔">
        <i class="fas fa-leaf"></i>
        <span>蔬蒔</span>
        <small>楊梅區四維路216號</small>
        <img src="https://i.postimg.cc/MZ5vHZ6j/216.jpg" alt="蔬蒔" class="location-thumbnail" data-full-image="https://i.postimg.cc/MZ5vHZ6j/216.jpg">
      </button>
      <button class="location-tab" data-location="金正好吃">
        <i class="fas fa-utensils"></i>
        <span>金正好吃</span>
        <small>楊梅區四維路218號</small>
        <img src="https://i.postimg.cc/bYgsrYyd/218.jpg" alt="金正好吃" class="location-thumbnail" data-full-image="https://i.postimg.cc/bYgsrYyd/218.jpg">
      </button>
    </div>
    
    <!-- 動態場地資訊 -->
    <div id="locationInfo" class="location-info">
      <h3><i class="fas fa-map-marker-alt"></i> 楊梅區四維路59號</h3>
      <div class="special-notice">
        <i class="fas fa-exclamation-triangle"></i>
        <span>整月都可排班</span>
      </div>
      <div class="info-grid">
        <div class="info-item">
          <i class="fas fa-clock"></i>
          <span><strong>營業時間：</strong>14:00-20:00</span>
        </div>
        <div class="info-item">
          <i class="fas fa-dollar-sign"></i>
          <span><strong>費用：</strong>600元/天</span>
        </div>
        <div class="info-item">
          <i class="fas fa-truck"></i>
          <span><strong>限制：</strong>僅限1車，餐車高度限制</span>
        </div>
        <div class="info-item">
          <i class="fas fa-ban"></i>
          <span><strong>禁止：</strong>油炸落地攤、煙霧太大、飲料車</span>
        </div>
      </div>
    </div>
  </div>

  <!-- 報名表單 -->
  <div class="card" id="form">
    <h2 class="section-title">📝 線上報名表</h2>
    <div class="form-grid">
      <div>
        <label><i class="fas fa-store"></i> 餐車名稱</label>
        <input type="text" id="vendorName" placeholder="例如：向陽坡刈包">
      </div>
      <div>
        <label><i class="fas fa-map-marker-alt"></i> 選擇場地</label>
      <select id="location">
          <option value="">請選擇場地</option>
        <option value="四維路59號">四維路59號</option>
          <option value="四維路60號">四維路60號</option>
          <option value="漢堡大亨">漢堡大亨 - 四維路70號</option>
          <option value="自由風">自由風 - 四維路190號</option>
          <option value="蔬蒔">蔬蒔 - 四維路216號</option>
          <option value="金正好吃">金正好吃 - 四維路218號</option>
      </select>
      </div>
      <div>
        <label><i class="fas fa-calendar"></i> 選擇日期</label>
        <div class="date-selection">
          <input type="date" id="date" style="display:none;">
          <select id="availableDates">
            <option value="">請先選擇場地</option>
      </select>
        </div>
        <div id="dateInfo" class="date-info">
          <small><i class="fas fa-info-circle"></i> 請先選擇場地</small>
        </div>
      </div>
      <div>
        <label><i class="fas fa-utensils"></i> 餐車類型</label>
        <select id="foodType">
          <option value="">請選擇</option>
          <option value="主食類">主食類</option>
          <option value="甜點類">甜點類</option>
          <option value="小點類">小點類</option>
          <option value="中式餐點">中式餐點</option>
          <option value="烤腿套餐">烤腿套餐</option>
          <option value="甜品類">甜品類</option>
          <option value="小吃類型">小吃類型</option>
      </select>
      </div>
      <div class="fee-info">
        <label><i class="fas fa-dollar-sign"></i> 場地費</label>
        <div class="fee-input-group">
          <i class="fas fa-coins"></i>
          <input type="text" value="600元/天 (14:00-20:00)" disabled readonly>
        </div>
      </div>
  </div>
    
    <div class="notice-box" id="noticeBox">
      <h4><i class="fas fa-exclamation-triangle"></i> 重要注意事項</h4>
      <ul>
        <li>不供水、不供電，需自行清潔環境及垃圾處理</li>
        <li>禁止油炸落地攤，其他可以不限，禁煙霧太大</li>
        <li>禁止飲料及飲料車</li>
        <li>餐車高度限制，請特別注意</li>
        <li>房東很注重地板要記得鋪地墊</li>
        <li>桶仔雞煙霧太大不行</li>
        <li>發電機老式太吵不行</li>
      </ul>
    </div>
    
    <button class="submit" id="submitBtn">
      <i class="fas fa-paper-plane"></i> 送出報名
    </button>
  </div>

</div>

<!-- 圖片放大模態框 -->
<div id="imageModal" class="image-modal">
  <span class="modal-close">&times;</span>
  <img class="modal-content" id="modalImage" src="" alt="">
</div>

<!-- 繳費彈窗 -->
<div id="paymentModal" class="payment-modal">
  <div class="payment-modal-content">
    <div class="payment-header">
      <h3><i class="fas fa-credit-card"></i> 繳交場地費</h3>
      <span class="modal-close" onclick="closePaymentModal()">&times;</span>
    </div>
    <div class="payment-body">
      <div class="payment-info">
        <p style="font-size: 1.05rem; margin: 5px 0;"><strong>場地費：600元</strong></p>
        <p style="font-size: 0.9rem; margin: 5px 0;">請選擇付款方式完成繳費</p>
      </div>
      <div class="payment-buttons">
        <button class="payment-btn jkopay-btn" onclick="openJkopay()">
          <i class="fas fa-mobile-alt"></i>
          <span>街口支付</span>
        </button>
        <button class="payment-btn linepay-btn" onclick="openLinepay()">
          <i class="fab fa-line"></i>
          <span>LINE-PAY</span>
        </button>
        <button class="payment-btn bank-btn" onclick="openBankModal()">
          <i class="fas fa-university"></i>
          <span>網銀轉帳</span>
        </button>
      </div>
      <div class="payment-notice">
        <p><i class="fas fa-info-circle"></i> 繳費完成後，請將截圖或訊息傳至<a href="https://lin.ee/BStZlfM" target="_blank" style="color: #00C300; font-weight: bold; text-decoration: underline; cursor: pointer;">官方小幫手</a></p>
      </div>
    </div>
  </div>
</div>

<!-- 銀行轉帳資料彈窗 -->
<div id="bankModal" class="bank-modal">
  <div class="bank-modal-content">
    <div class="bank-header">
      <h3><i class="fas fa-university"></i> 銀行轉帳資訊</h3>
      <span class="modal-close" onclick="closeBankModal()">&times;</span>
    </div>
    <div class="bank-body">
      <div class="bank-info">
        <div class="bank-item">
          <label>銀行名稱：</label>
          <span>渣打銀行</span>
        </div>
        <div class="bank-item">
          <label>銀行代號：</label>
          <span>052</span>
        </div>
        <div class="bank-item">
          <label>帳號：</label>
          <div class="account-number">
            <span id="accountNumber">02420000547239</span>
            <button class="copy-btn" onclick="copyAccountNumber()">
              <i class="fas fa-copy"></i> 複製
            </button>
          </div>
        </div>
        <div class="bank-amount">
          <label>轉帳金額：</label>
          <span class="amount">600元</span>
        </div>
      </div>
      <div class="bank-notice">
        <p><i class="fas fa-exclamation-triangle"></i> 轉帳完成後，請將轉帳截圖或訊息傳至<a href="https://lin.ee/BStZlfM" target="_blank" style="color: #00C300; font-weight: bold; text-decoration: underline;">官方小幫手</a></p>
        <button class="official-account-btn" onclick="openOfficialAccount()">
          <i class="fab fa-line"></i> 傳送至官方小幫手
        </button>
      </div>
    </div>
  </div>
</div>

<!-- 管理選項彈窗（取消/審計二選一）-->
<div id="adminOptionsModal" class="cancel-modal">
  <div class="cancel-modal-content" style="max-width: 420px;">
    <div class="cancel-header" style="background: linear-gradient(135deg, #667eea, #764ba2);">
      <h3><i class="fas fa-cog"></i> 系統管理選項</h3>
      <span class="modal-close" onclick="closeAdminOptionsModal()">&times;</span>
    </div>
    <div class="cancel-body">
      <div class="cancel-info">
        <div class="booking-details">
          <h4><i class="fas fa-info-circle"></i> 預約資訊</h4>
          <div class="detail-item">
            <label>餐車名稱：</label>
            <span id="adminVendorName"></span>
          </div>
          <div class="detail-item">
            <label>場地：</label>
            <span id="adminLocation"></span>
          </div>
          <div class="detail-item">
            <label>日期：</label>
            <span id="adminDate"></span>
          </div>
          <div class="detail-item">
            <label>付款狀態：</label>
            <span id="adminPaymentStatus" style="font-weight: bold;"></span>
          </div>
        </div>
      </div>
      
      <div class="cancel-options">
        <div style="background: #e3f2fd; border-left: 4px solid #2196f3; padding: 12px; margin-bottom: 15px; border-radius: 6px;">
          <p style="margin: 0; color: #1976d2; font-size: 0.9rem;">
            <i class="fas fa-info-circle"></i> 請選擇要執行的管理操作
          </p>
        </div>
        
        <div class="cancel-buttons" style="gap: 12px;">
          <button class="contact-support-btn" style="background: linear-gradient(135deg, #28a745, #20c997);" onclick="selectAuditOption()">
            <i class="fas fa-check-circle"></i> 己繳場租審計
          </button>
          <button class="password-cancel-btn" style="background: linear-gradient(135deg, #dc3545, #c82333);" onclick="selectCancelOption()">
            <i class="fas fa-times-circle"></i> 取消預約
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- 取消預約彈窗 -->
<div id="cancelModal" class="cancel-modal">
  <div class="cancel-modal-content">
    <div class="cancel-header">
      <h3><i class="fas fa-calendar-times"></i> 取消預約</h3>
      <span class="modal-close" onclick="closeCancelModal()">&times;</span>
    </div>
    <div class="cancel-body">
      <div class="cancel-info">
        <div class="booking-details">
          <h4><i class="fas fa-info-circle"></i> 預約詳情</h4>
          <div class="detail-item">
            <label>餐車名稱：</label>
            <span id="cancelVendorName"></span>
          </div>
          <div class="detail-item">
            <label>場地：</label>
            <span id="cancelLocation"></span>
          </div>
          <div class="detail-item">
            <label>日期：</label>
            <span id="cancelDate"></span>
          </div>
          <div class="detail-item">
            <label>時間：</label>
            <span>14:00-20:00</span>
          </div>
        </div>
      </div>
      
      <div class="cancel-options">
        <div class="cancel-notice">
          <p><i class="fas fa-exclamation-triangle"></i> 無法自行取消預約，請洽<a href="https://lin.ee/BStZlfM" target="_blank" style="color: #00C300; font-weight: bold; text-decoration: underline;">官方小幫手</a></p>
        </div>
        
        <div class="cancel-buttons">
          <button class="contact-support-btn" onclick="openOfficialAccount()">
            <i class="fab fa-line"></i> 聯繫官方小幫手
          </button>
          <button class="password-cancel-btn" onclick="showPasswordInput()">
            <i class="fas fa-key"></i> 密碼取消預約
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- 密碼輸入彈窗 -->
<div id="passwordModal" class="password-modal">
  <div class="password-modal-content" style="max-width: 420px;">
    <div class="password-header" style="background: linear-gradient(135deg, #667eea, #764ba2); padding: 20px;">
      <h3 style="font-size: 1.3rem;"><i class="fas fa-shield-alt"></i> 密碼驗證</h3>
      <span class="modal-close" onclick="closePasswordModal()">&times;</span>
    </div>
    <div class="password-body" style="padding: 25px;">
      <div class="password-info">
        <div style="text-align: center; margin-bottom: 20px;">
          <div style="width: 60px; height: 60px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 50%; margin: 0 auto 12px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);">
            <i class="fas fa-lock" style="font-size: 1.6rem; color: white;"></i>
          </div>
          <p style="font-size: 1.05rem; color: #333; margin: 0 0 6px 0; font-weight: bold;">請輸入取消密碼</p>
          <p style="font-size: 0.85rem; color: #666; margin: 0;">驗證後即可取消預約</p>
        </div>
        
        <div class="password-input-group" style="flex-direction: column; gap: 12px;">
          <div style="position: relative;">
            <i class="fas fa-key" style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: #667eea; font-size: 1rem;"></i>
            <input type="password" id="passwordInput" placeholder="請輸入密碼" maxlength="10" style="padding-left: 40px; border: 2px solid #e0e0e0; font-size: 1rem; height: 45px; text-align: center; letter-spacing: 2px;">
          </div>
          <button class="password-submit-btn" onclick="verifyPassword()" style="width: 100%; height: 45px; font-size: 1rem; background: linear-gradient(135deg, #667eea, #764ba2); box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);">
            <i class="fas fa-check-circle"></i> 確認驗證
          </button>
        </div>
        
        <div style="background: #f8f9fa; border-left: 3px solid #667eea; padding: 10px 12px; margin-top: 15px; border-radius: 4px;">
          <p style="margin: 0; color: #666; font-size: 0.8rem; line-height: 1.4;">
            <i class="fas fa-info-circle" style="color: #667eea;"></i> 如忘記密碼，請聯繫<a href="https://lin.ee/BStZlfM" target="_blank" style="color: #00C300; font-weight: bold; text-decoration: underline;">官方小幫手</a>
          </p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- 己繳場租審計彈窗 -->
<div id="auditModal" class="cancel-modal">
  <div class="cancel-modal-content">
    <div class="cancel-header" style="background: linear-gradient(135deg, #28a745, #20c997);">
      <h3><i class="fas fa-check-circle"></i> 己繳場租審計</h3>
      <span class="modal-close" onclick="closeAuditModal()">&times;</span>
    </div>
    <div class="cancel-body">
      <div class="cancel-info">
        <div class="booking-details">
          <h4><i class="fas fa-info-circle"></i> 己繳詳情</h4>
          <div class="detail-item">
            <label>餐車名稱：</label>
            <span id="auditVendorName"></span>
          </div>
          <div class="detail-item">
            <label>場地：</label>
            <span id="auditLocation"></span>
          </div>
          <div class="detail-item">
            <label>日期：</label>
            <span id="auditDate"></span>
          </div>
          <div class="detail-item">
            <label>時間：</label>
            <span>14:00-20:00</span>
          </div>
        </div>
      </div>
      
      <div class="cancel-options">
        <div class="cancel-notice">
          <p><i class="fas fa-exclamation-triangle"></i> 如未審計請洽<a href="https://lin.ee/BStZlfM" target="_blank" style="color: #00C300; font-weight: bold; text-decoration: underline;">官方小幫手</a></p>
        </div>
        
        <div class="cancel-buttons">
          <button class="contact-support-btn" onclick="openOfficialAccount()">
            <i class="fab fa-line"></i> 聯繫官方小幫手
          </button>
          <button class="password-cancel-btn" style="background: linear-gradient(135deg, #28a745, #20c997);" onclick="showAuditPasswordInput()">
            <i class="fas fa-key"></i> 密碼確認繳費
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- 審計密碼輸入彈窗 -->
<div id="auditPasswordModal" class="password-modal">
  <div class="password-modal-content" style="max-width: 420px;">
    <div class="password-header" style="background: linear-gradient(135deg, #28a745, #20c997); padding: 20px;">
      <h3 style="font-size: 1.3rem;"><i class="fas fa-shield-alt"></i> 審計密碼驗證</h3>
      <span class="modal-close" onclick="closeAuditPasswordModal()">&times;</span>
    </div>
    <div class="password-body" style="padding: 25px;">
      <div class="password-info">
        <div style="text-align: center; margin-bottom: 20px;">
          <div style="width: 60px; height: 60px; background: linear-gradient(135deg, #28a745, #20c997); border-radius: 50%; margin: 0 auto 12px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);">
            <i class="fas fa-lock" style="font-size: 1.6rem; color: white;"></i>
          </div>
          <p style="font-size: 1.05rem; color: #333; margin: 0 0 6px 0; font-weight: bold;">請輸入審計密碼</p>
          <p style="font-size: 0.85rem; color: #666; margin: 0;">驗證後將更新為「己繳款」</p>
        </div>
        
        <div class="password-input-group" style="flex-direction: column; gap: 12px;">
          <div style="position: relative;">
            <i class="fas fa-key" style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: #28a745; font-size: 1rem;"></i>
            <input type="password" id="auditPasswordInput" placeholder="請輸入密碼" maxlength="10" style="padding-left: 40px; border: 2px solid #e0e0e0; font-size: 1rem; height: 45px; text-align: center; letter-spacing: 2px;">
          </div>
          <button class="password-submit-btn" onclick="verifyAuditPassword()" style="width: 100%; height: 45px; font-size: 1rem; background: linear-gradient(135deg, #28a745, #20c997); box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);">
            <i class="fas fa-check-circle"></i> 確認審計
          </button>
        </div>
        
        <div style="background: #f8f9fa; border-left: 3px solid #28a745; padding: 10px 12px; margin-top: 15px; border-radius: 4px;">
          <p style="margin: 0; color: #666; font-size: 0.8rem; line-height: 1.4;">
            <i class="fas fa-info-circle" style="color: #28a745;"></i> 如忘記密碼，請聯繫<a href="https://lin.ee/BStZlfM" target="_blank" style="color: #00C300; font-weight: bold; text-decoration: underline;">官方小幫手</a>
          </p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- 排班釋出彈窗 -->
<div id="transferModal" class="password-modal">
  <div class="password-modal-content" style="max-width: 450px;">
    <div class="password-header" style="background: linear-gradient(135deg, #FF8A00, #FF4B2B);">
      <h3><i class="fas fa-exchange-alt"></i> 排班釋出</h3>
      <span class="modal-close" onclick="closeTransferModal()">&times;</span>
    </div>
    <div class="password-body" style="padding: 18px;">
      <div class="transfer-info">
        <div style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 10px 12px; margin-bottom: 12px; border-radius: 6px;">
          <p style="margin: 0; color: #856404; font-size: 0.82rem; line-height: 1.4;">
            <i class="fas fa-info-circle"></i> <strong>釋出說明：</strong>請先完成場租交易後再填寫
          </p>
        </div>
        
        <div class="original-booking-info" style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 10px; margin-bottom: 12px;">
          <h4 style="margin-bottom: 8px; color: #FF4B2B; font-size: 0.9rem;">原預約資訊</h4>
          <div class="detail-item" style="margin-bottom: 6px; padding: 4px 0;">
            <label style="margin: 0; font-size: 0.8rem; min-width: 50px;">原餐車：</label>
            <span id="transferOriginalVendor" style="font-weight: bold; color: #dc3545; font-size: 0.85rem;"></span>
          </div>
          <div class="detail-item" style="margin-bottom: 6px; padding: 4px 0;">
            <label style="margin: 0; font-size: 0.8rem; min-width: 50px;">場地：</label>
            <span id="transferLocation" style="font-size: 0.85rem;"></span>
          </div>
          <div class="detail-item" style="padding: 4px 0; border: none;">
            <label style="margin: 0; font-size: 0.8rem; min-width: 50px;">日期：</label>
            <span id="transferDate" style="font-size: 0.85rem;"></span>
          </div>
        </div>
        
        <div class="transfer-form">
          <h4 style="margin-bottom: 10px; color: #FF4B2B; font-size: 0.9rem;">接手餐車資訊</h4>
          
          <label style="margin-top: 8px; font-size: 0.85rem;">新店名 <span style="color: red;">*</span></label>
          <input type="text" id="transferVendorName" placeholder="請輸入餐車名稱" required style="font-size: 0.88rem; padding: 8px;">
          
          <label style="margin-top: 8px; font-size: 0.85rem;">餐車類型 <span style="color: red;">*</span></label>
          <select id="transferFoodType" required style="font-size: 0.88rem; padding: 8px;">
            <option value="">請選擇</option>
            <option value="主食類">主食類</option>
            <option value="甜點類">甜點類</option>
            <option value="小點類">小點類</option>
            <option value="中式餐點">中式餐點</option>
            <option value="烤腿套餐">烤腿套餐</option>
            <option value="甜品類">甜品類</option>
            <option value="小吃類型">小吃類型</option>
          </select>
          
          <label style="margin-top: 8px; font-size: 0.85rem;">換班密碼 <span style="color: red;">*</span></label>
          <div style="position: relative;">
            <i class="fas fa-key" style="position: absolute; left: 10px; top: 50%; transform: translateY(-50%); color: #FF8A00; font-size: 0.9rem;"></i>
            <input type="password" id="transferPassword" placeholder="請輸入換班密碼" maxlength="20" style="padding: 8px; padding-left: 35px; font-size: 0.88rem; height: 38px;">
          </div>
          
          <div style="background: #e3f2fd; border: 1px solid #2196f3; border-radius: 6px; padding: 8px 10px; margin-top: 12px;">
            <p style="margin: 0; color: #1976d2; font-size: 0.78rem; line-height: 1.4;">
              <i class="fas fa-exclamation-circle"></i> 釋出後將替換為新餐車，需自行完成場租交易
            </p>
          </div>
          
          <button class="password-submit-btn" onclick="submitTransfer()" style="width: 100%; margin-top: 12px; padding: 10px 12px; font-size: 0.9rem; height: 42px; background: linear-gradient(135deg, #FF8A00, #FF4B2B);">
            <i class="fas fa-exchange-alt"></i> 確認釋出換班
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- 使用教學彈窗 -->
<div id="helpModal" class="password-modal">
  <div class="password-modal-content" style="max-width: 550px;">
    <div class="password-header" style="background: linear-gradient(135deg, #17a2b8, #138496); padding: 20px;">
      <h3 style="font-size: 1.3rem;"><i class="fas fa-graduation-cap"></i> 使用教學</h3>
      <span class="modal-close" onclick="closeHelpModal()">&times;</span>
    </div>
    <div class="password-body" style="padding: 25px; max-height: 70vh; overflow-y: auto;">
      <div class="help-content">
        
        <div class="help-section">
          <h4 style="color: #FF4B2B; font-size: 1.1rem; margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
            <i class="fas fa-calendar-check"></i> 如何預約排班？
          </h4>
          <ul style="line-height: 1.8; color: #555; font-size: 0.9rem; padding-left: 20px;">
            <li><strong>方法1：快速預約</strong><br>直接點擊日曆上的<span style="background: #fff5f0; padding: 2px 6px; border-radius: 4px; color: #FF8A00;">空白日期</span>，系統會自動填入場地和日期</li>
            <li><strong>方法2：表單預約</strong><br>下滑到報名表單，依序填寫餐車名稱、場地、日期等資訊</li>
            <li>送出後會顯示<span style="background: #fff3cd; padding: 2px 6px; border-radius: 4px; color: #856404;">繳費彈窗</span>，請在24小時內完成付款</li>
          </ul>
        </div>
        
        <div class="help-section" style="margin-top: 20px;">
          <h4 style="color: #28a745; font-size: 1.1rem; margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
            <i class="fas fa-credit-card"></i> 付款說明
          </h4>
          <ul style="line-height: 1.8; color: #555; font-size: 0.9rem; padding-left: 20px;">
            <li>預約後需在<strong style="color: #dc3545;">24小時內付款</strong>，否則將變成<span style="background: #f8d7da; padding: 2px 6px; border-radius: 4px; color: #721c24;">逾繳可排</span>狀態</li>
            <li>支援街口支付、LINE-PAY、銀行轉帳三種方式</li>
            <li>付款完成後，請將截圖傳至<a href="https://lin.ee/BStZlfM" target="_blank" style="color: #00C300; font-weight: bold; text-decoration: underline;">官方小幫手</a></li>
            <li>付款狀態會顯示為<span style="background: #d4edda; padding: 2px 6px; border-radius: 4px; color: #155724;">✓ 已付款</span></li>
          </ul>
        </div>
        
        <div class="help-section" style="margin-top: 20px;">
          <h4 style="color: #ffc107; font-size: 1.1rem; margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
            <i class="fas fa-exchange-alt"></i> 轉讓排班
          </h4>
          <ul style="line-height: 1.8; color: #555; font-size: 0.9rem; padding-left: 20px;">
            <li>點擊<span style="background: #d4edda; padding: 2px 6px; border-radius: 4px; color: #155724;">已付款</span>的排班，可以將排班轉讓給其他餐車</li>
            <li>需先與接手餐車私下完成場租交易</li>
            <li>填寫接手餐車資訊和換班密碼即可完成轉讓</li>
            <li>轉讓成功後，<strong>系統會自動通知<a href="https://lin.ee/BStZlfM" target="_blank" style="color: #00C300; font-weight: bold; text-decoration: underline;">官方小幫手</a></strong>：「訊息已轉給 <span style="color: #FF8A00; font-weight: bold;">[接手餐車名稱]</span> 協助轉讓排班」</li>
          </ul>
        </div>
        
        <div class="help-section" style="margin-top: 20px;">
          <h4 style="color: #dc3545; font-size: 1.1rem; margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
            <i class="fas fa-times-circle"></i> 取消預約
          </h4>
          <ul style="line-height: 1.8; color: #555; font-size: 0.9rem; padding-left: 20px;">
            <li>如需取消預約，請<strong>聯繫<a href="https://lin.ee/BStZlfM" target="_blank" style="color: #00C300; font-weight: bold; text-decoration: underline;">官方小幫手</a></strong>協助處理</li>
            <li>提供您的<span style="background: #17a2b8; color: white; padding: 2px 6px; border-radius: 4px;">餐車名稱</span>、<span style="background: #17a2b8; color: white; padding: 2px 6px; border-radius: 4px;">預約日期</span>、<span style="background: #17a2b8; color: white; padding: 2px 6px; border-radius: 4px;">場地名稱</span></li>
            <li>小幫手確認後將為您取消排班</li>
          </ul>
        </div>
        
        <div class="help-section" style="margin-top: 20px;">
          <h4 style="color: #6c5ce7; font-size: 1.1rem; margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
            <i class="fas fa-hand-holding-usd"></i> 接手逾期排班
          </h4>
          <ul style="line-height: 1.8; color: #555; font-size: 0.9rem; padding-left: 20px;">
            <li>逾期未付款的排班會顯示<span style="background: #dc3545; color: white; padding: 2px 6px; border-radius: 4px; font-size: 0.85rem;">❌ 逾繳可排</span></li>
            <li>點擊該排班即可接手，填寫您的餐車資訊</li>
            <li>接手後需在24小時內完成付款</li>
          </ul>
        </div>
        
        <div style="background: linear-gradient(135deg, #e3f2fd, #bbdefb); border: 2px solid #2196f3; border-radius: 10px; padding: 15px; margin-top: 20px; text-align: center;">
          <p style="margin: 0 0 10px 0; color: #1976d2; font-size: 1rem; font-weight: bold;">
            <i class="fas fa-headset"></i> 需要協助？
          </p>
          <button onclick="openOfficialAccount(); closeHelpModal();" style="background: linear-gradient(135deg, #00C300, #00A000); color: white; border: none; padding: 12px 20px; border-radius: 8px; cursor: pointer; font-size: 1rem; font-weight: bold; transition: all 0.3s; box-shadow: 0 4px 15px rgba(0, 195, 0, 0.3);">
            <i class="fab fa-line"></i> 聯繫官方小幫手
          </button>
        </div>
        
      </div>
    </div>
  </div>
</div>

<!-- 逾期接手彈窗 -->
<div id="takeoverModal" class="payment-modal">
  <div class="payment-modal-content">
    <div class="payment-header">
      <h3><i class="fas fa-hand-holding-usd"></i> 接手預約</h3>
      <span class="modal-close" onclick="closeTakeoverModal()">&times;</span>
    </div>
    <div class="payment-body" style="padding: 18px;">
      <div class="takeover-info">
        <div class="alert-warning" style="padding: 8px 10px; margin-bottom: 10px;">
          <i class="fas fa-exclamation-triangle"></i>
          <p style="font-size: 0.82rem; margin: 0;">此預約已逾期，可接手</p>
        </div>
        
        <div class="original-booking-info" style="padding: 10px; margin-bottom: 10px; background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 8px;">
          <h4 style="margin: 0; font-size: 0.88rem; line-height: 1.4; color: #495057;">
            原預約：<span id="originalVendor" style="color: #dc3545; font-weight: bold;"></span><br>
            <span style="font-size: 0.82rem; color: #6c757d;">
              <i class="fas fa-map-marker-alt" style="font-size: 0.75rem;"></i> <span id="takeoverLocation"></span> | 
              <i class="fas fa-calendar" style="font-size: 0.75rem;"></i> <span id="takeoverDate"></span>
            </span>
          </h4>
        </div>
        
        <div class="takeover-form">
          <h4 style="margin-bottom: 10px; font-size: 0.9rem; color: #FF4B2B;">您的資訊</h4>
          
          <label style="margin-top: 8px; font-size: 0.85rem;">店名 <span style="color: red;">*</span></label>
          <input type="text" id="takeoverVendorName" placeholder="請輸入餐車名稱" required style="margin-top: 4px; font-size: 0.9rem; padding: 8px;">
          
          <label style="margin-top: 8px; font-size: 0.85rem;">類型 <span style="color: red;">*</span></label>
          <select id="takeoverFoodType" required style="margin-top: 4px; font-size: 0.9rem; padding: 8px;">
            <option value="">請選擇</option>
            <option value="主食類">主食類</option>
            <option value="甜點類">甜點類</option>
            <option value="小點類">小點類</option>
            <option value="中式餐點">中式餐點</option>
            <option value="烤腿套餐">烤腿套餐</option>
            <option value="甜品類">甜品類</option>
            <option value="小吃類型">小吃類型</option>
          </select>
          
          <div class="locked-info" style="margin-top: 8px;">
            <label style="margin: 0; font-size: 0.85rem;"><i class="fas fa-dollar-sign"></i> 場地費</label>
            <div class="fee-input-group" style="margin-top: 4px;">
              <i class="fas fa-coins" style="font-size: 0.9rem; left: 10px;"></i>
              <input type="text" value="600元/天" disabled readonly style="background: linear-gradient(135deg, #e8f5e9, #c8e6c9); color: #2e7d32; font-weight: bold; cursor: not-allowed; border: 2px solid #4caf50; padding: 8px; padding-left: 32px; font-size: 0.88rem;">
            </div>
          </div>
          
          <div class="takeover-notice" style="background: #e7f3ff; border: 1px solid #2196f3; border-radius: 6px; padding: 8px 10px; margin-top: 10px;">
            <p style="font-size: 0.8rem; margin: 0; color: #1976d2;"><i class="fas fa-clock"></i> 接手後需在24小時內付款</p>
          </div>
          
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-top: 12px;">
            <button id="takeoverSubmitBtn" class="submit" onclick="submitTakeover()" style="background: linear-gradient(135deg,#ffc107,#ff9800); margin: 0; padding: 10px 8px; font-size: 0.88rem;">
              <i class="fas fa-hand-holding"></i> 確認接手
            </button>
            <button class="submit" onclick="closeTakeoverModal(); showPaymentModal();" style="background: linear-gradient(135deg,#28a745,#20c997); margin: 0; padding: 10px 8px; font-size: 0.88rem;">
              <i class="fas fa-credit-card"></i> 原班繳費
            </button>
          </div>
          
          <div style="background: #fff3cd; border: 1px solid #ffc107; border-radius: 6px; padding: 8px 10px; margin-top: 10px;">
            <p style="margin: 0; color: #856404; font-size: 0.78rem; line-height: 1.4;">
              <i class="fas fa-exclamation-triangle"></i> <strong>原班繳費：</strong><span style="color: #dc3545; font-weight: bold;">遲繳</span>仍可能<span style="color: #dc3545; font-weight: bold;">被排班</span>，請儘快通知<a href="https://lin.ee/BStZlfM" target="_blank" style="color: #00C300; font-weight: bold; text-decoration: underline;">小幫手</a>確認
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- 外部JavaScript -->
<script src="script.js"></script>


<!-- Toast 容器 -->
<div class="toast-container" id="toastContainer"></div>

<!-- 載入狀態指示器 -->
<div class="loading-overlay" id="loadingOverlay">
  <div class="loading-spinner">
    <div class="spinner"></div>
    <p id="loadingMessage">處理中...</p>
  </div>
</div>

<!-- 同步狀態指示器 -->
<div id="syncStatus" class="sync-status">
  <i class="fas fa-sync-alt"></i>
  <span>同步中...</span>
</div>

<!-- 群組版規彈窗 -->
<div id="rulesModal" class="password-modal">
  <div class="password-modal-content" style="max-width: 700px; max-height: 85vh; overflow-y: auto;">
    <div class="password-header" style="background: linear-gradient(135deg, #ffc107, #ff9800); padding: 20px;">
      <h3 style="font-size: 1.3rem;"><i class="fas fa-book"></i> 四維商圈美食餐車群組版規</h3>
      <span class="modal-close" onclick="closeRulesModal()">&times;</span>
    </div>
    <div class="password-body" style="padding: 20px;">
      
      <div class="rule-section" style="margin-bottom: 20px; padding: 15px; background: #fff3cd; border-left: 4px solid #ffc107; border-radius: 8px;">
        <h4 style="color: #ff9800; margin-bottom: 10px;"><i class="fas fa-star"></i> 歡迎新夥伴加入</h4>
        <p style="line-height: 1.8; color: #666;">進群前後，請將LINE名稱改為【品牌名稱】；如有兩人以上，另一位請用【品牌名稱-小幫手】或【品牌名稱-2】。</p>
        <p style="line-height: 1.8; color: #666;">名稱更改後，請將【品牌簡介、餐車品項、菜單價格】貼至記事本，方便大家認識彼此。</p>
      </div>

      <div class="rule-section" style="margin-bottom: 15px;">
        <h4 style="color: #FF4B2B; margin-bottom: 8px;"><i class="fas fa-clipboard-check"></i> 1. 營業公告與預訂規範</h4>
        <ul style="line-height: 1.8; color: #666; padding-left: 20px;">
          <li>營業日前2天，請於訂購群記事本張貼預訂公告。</li>
          <li>推播僅限營業前一日19:00後。</li>
          <li>現場作業請以預訂單為優先。</li>
        </ul>
      </div>

      <div class="rule-section" style="margin-bottom: 15px;">
        <h4 style="color: #FF4B2B; margin-bottom: 8px;"><i class="fas fa-dollar-sign"></i> 2. 場地費繳交規定</h4>
        <ul style="line-height: 1.8; color: #666; padding-left: 20px;">
          <li>線上排班後，請於<strong>24小時內完成場地費繳交</strong>，並截圖告知小幫手。</li>
          <li>支援<strong>街口支付、LINE Pay、銀行轉帳</strong>三種付款方式。</li>
          <li>超過24小時未繳，該場次自動下架，需重新報班。</li>
          <li>付款完成後狀態將變更為「已付款」，排班確定。</li>
        </ul>
      </div>

      <div class="rule-section" style="margin-bottom: 15px;">
        <h4 style="color: #FF4B2B; margin-bottom: 8px;"><i class="fas fa-broom"></i> 3. 環境與清潔</h4>
        <ul style="line-height: 1.8; color: #666; padding-left: 20px;">
          <li>設攤及營業時請保持環境整潔。</li>
          <li>開攤前後請拍照上傳群組。</li>
        </ul>
      </div>

      <div style="padding: 15px; background: #d4edda; border-left: 4px solid #28a745; border-radius: 8px; margin-top: 20px;">
        <p style="margin: 0; color: #155724; font-weight: bold;">
          <i class="fas fa-phone"></i> 官方帳號小幫手：
          <a href="https://lin.ee/BStZlfM" target="_blank" style="color: #00C300; text-decoration: underline;">lin.ee/BStZlfM</a>
        </p>
      </div>
    </div>
  </div>
</div>

<!-- 下載素材彈窗 -->
<div id="downloadModal" class="password-modal">
  <div class="password-modal-content" style="max-width: 600px;">
    <div class="password-header" style="background: linear-gradient(135deg, #667eea, #764ba2); padding: 20px;">
      <h3 style="font-size: 1.3rem;"><i class="fas fa-download"></i> 下載素材</h3>
      <span class="modal-close" onclick="closeDownloadModal()">&times;</span>
    </div>
    <div class="password-body" style="padding: 20px;">
      <div style="text-align: center;">
        <img src="https://res.cloudinary.com/diiyszovx/image/upload/v1757929018/S__4653076_vzto17.jpg" 
             alt="四維商圈餐車QR Code海報" 
             style="max-width: 100%; height: auto; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.15); margin-bottom: 20px;">
        
        <h4 style="color: #667eea; margin-bottom: 10px;"><i class="fas fa-qrcode"></i> 四維商圈餐車QR Code海報</h4>
        <p style="color: #666; line-height: 1.8; margin-bottom: 15px;">供餐車主自行下載使用，設攤時張貼於明顯處推廣</p>
        <p style="color: #999; font-size: 0.9rem; margin-bottom: 20px;">規格：A4大小，高解析度</p>
        
        <a href="https://res.cloudinary.com/diiyszovx/image/upload/v1757929018/S__4653076_vzto17.jpg" 
           download="四維商圈餐車QRCode海報.jpg"
           class="btn btn-primary" 
           style="display: inline-block; padding: 12px 30px; background: linear-gradient(135deg, #667eea, #764ba2); color: white; text-decoration: none; border-radius: 25px; font-weight: bold;">
          <i class="fas fa-download"></i> 下載海報
        </a>
      </div>
      
      <div style="margin-top: 25px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
        <h4 style="color: #495057; margin-bottom: 10px;"><i class="fas fa-info-circle"></i> 使用說明</h4>
        <ul style="line-height: 1.8; color: #666; padding-left: 20px;">
          <li>請將海報列印成A4大小</li>
          <li>設攤時張貼於餐車明顯處</li>
          <li>方便客人掃描加入預訂社群</li>
          <li>如有問題請聯絡管理員</li>
        </ul>
      </div>
    </div>
  </div>
</div>

<!-- 版權警語 -->
<footer style="background: linear-gradient(135deg, #2c3e50, #34495e); color: white; padding: 20px 15px; text-align: center; margin-top: 30px; border-top: 3px solid #FF8A00;">
  <div style="max-width: 1200px; margin: 0 auto;">
    <p style="margin: 0 0 8px 0; font-size: 0.9rem;">
      系統開發：<a href="https://lin.ee/BStZlfM" target="_blank" style="color: #00C300; font-weight: bold; text-decoration: none; transition: all 0.3s;">快閃餐車小幫手</a> © 2025
    </p>
    <p style="margin: 0 0 10px 0; font-size: 0.8rem; color: #ffc107;">
      <i class="fas fa-exclamation-triangle"></i> 本系統受著作權法保護，未經授權不得複製、修改或用於商業用途
    </p>
    <p style="margin: 0 0 8px 0; font-size: 0.8rem;">
      <a href="https://foodcarshop.pages.dev/guide" target="_blank" style="color: #17a2b8; font-weight: bold; text-decoration: underline; transition: all 0.3s;">
        <i class="fas fa-shopping-cart"></i> 客製化餐車預購系統(示範)
      </a>
    </p>
    <p id="systemVersionDisplay" style="margin: 8px 0 0 0; font-size: 0.75rem; color: #95a5a6; font-family: monospace;">
      <i class="fas fa-code-branch"></i> 系統版本：v3.2.1 | <span id="browserMode">檢測中...</span>
    </p>
  </div>
</footer>

</body>
</html>

